"use strict";(self.webpackChunk_bitable_pack_demo=self.webpackChunk_bitable_pack_demo||[]).push([[792],{8194(a,x,s){var t=s(4848),c=s(6540),j=s(5338),r=s(3006),d=s(1098),f=(p,F,i)=>new Promise((m,h)=>{var D=l=>{try{n(i.next(l))}catch(e){h(e)}},C=l=>{try{n(i.throw(l))}catch(e){h(e)}},n=l=>l.done?m(l.value):Promise.resolve(l.value).then(D,C);n((i=i.apply(p,F)).next())});const{Title:S,Text:g}=d.o5,w="78e122ac-77eb-4792-a593-9f9c5c675130",V="ep-20260129111407-mm5xp",k=()=>{const[p,F]=(0,c.useState)(!1),[i,m]=(0,c.useState)(!1),[h,D]=(0,c.useState)("\u672A\u9009\u4E2D\u884C");if((0,c.useEffect)(()=>{let n=null;return(()=>f(void 0,null,function*(){try{yield r.UV.base.getSelection(),m(!0);const e=()=>f(void 0,null,function*(){try{const u=yield r.UV.base.getSelection();if(u.tableId&&u.recordId){const A=yield r.UV.base.getTableById(u.tableId),y=yield A.getFieldByName("\u59D3\u540D"),o=yield A.getCellValue(y.id,u.recordId);if(Array.isArray(o)&&o.length>0){const B=o.map(E=>E.text).join("");D(B||"\u65E0\u59D3\u540D")}else D("\u65E0\u59D3\u540D")}else D("\u672A\u9009\u4E2D\u884C")}catch(u){console.error("\u83B7\u53D6\u59D3\u540D\u5931\u8D25:",u)}});e(),n=r.UV.base.onSelectionChange(()=>e())}catch(e){console.error("SDK \u521D\u59CB\u5316\u5931\u8D25:",e),m(!0)}}))(),()=>{n&&n()}},[]),!i)return(0,t.jsx)("div",{style:{padding:20,textAlign:"center"},children:"\u6B63\u5728\u8FDE\u63A5\u98DE\u4E66..."});const C=()=>f(void 0,null,function*(){F(!0);try{const n=yield r.UV.base.getSelection(),{tableId:l,recordId:e}=n;if(!l||!e)throw new Error("\u8BF7\u5148\u9009\u4E2D\u4E00\u884C");const u=yield r.UV.base.getTableById(l),A=yield u.getFieldByName("\u59D3\u540D"),y=yield u.getCellValue(A.id,e);let o="";if(Array.isArray(y)&&y.length>0&&(o=y.map(U=>U.text).join("")),!o)throw new Error("\u8BE5\u884C\u59D3\u540D\u4E3A\u7A7A");const B=yield u.getFieldByName("\u5DE5\u5546\u6863\u6848"),E=yield u.getCellValue(B.id,e);if(!E||E.length===0)throw new Error("\u8BE5\u884C\u6CA1\u6709\u5DE5\u5546\u6863\u6848\u9644\u4EF6");d.y8.info("\u6B63\u5728\u83B7\u53D6\u6587\u4EF6\u5E76\u547C\u53EB\u8C46\u5305 AI...");const N=E[0],v=yield u.getAttachmentUrl(N.token,B.id,e);if(!v)throw new Error("\u83B7\u53D6\u9644\u4EF6\u94FE\u63A5\u5931\u8D25");const b=yield(yield fetch("https://ark.cn-beijing.volces.com/api/v3/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify({model:V,messages:[{role:"system",content:"\u4F60\u662F\u4E00\u4E2A\u8BC1\u4EF6\u63D0\u53D6\u4E13\u5BB6\uFF0C\u53EA\u9700\u8FD4\u56DE18\u4F4D\u8EAB\u4EFD\u8BC1\u53F7\uFF0C\u4E0D\u5339\u914D\u5219\u8FD4\u56DE'\u672A\u5339\u914D'\u3002"},{role:"user",content:[{type:"text",text:`\u8BF7\u4ECE\u6587\u6863\u4E2D\u63D0\u53D6\u59D3\u540D\u662F"${o}"\u7684\u4EBA\u768418\u4F4D\u8EAB\u4EFD\u8BC1\u53F7\u3002\u4E0D\u8981\u89E3\u91CA\u8BF4\u660E\u3002`},{type:"image_url",image_url:{url:v}}]}]})})).json();if(b.error)throw new Error(b.error.message);const I=b.choices[0].message.content.trim(),T=yield u.getFieldByName("\u8EAB\u4EFD\u8BC1\u53F7");yield u.setCellValue(T.id,e,[{type:"text",text:I}]),d.y8.success(I==="\u672A\u5339\u914D"?"AI \u672A\u53D1\u73B0\u5339\u914D\u4FE1\u606F":"\u63D0\u53D6\u5E76\u586B\u5165\u6210\u529F\uFF01")}catch(n){d.y8.error("\u62A5\u9519\u63D0\u793A\uFF1A"+n.message),console.error(n)}finally{F(!1)}});return(0,t.jsxs)("div",{style:{padding:20},children:[(0,t.jsx)(S,{heading:4,style:{marginBottom:12},children:"\u{1F194} ID \u667A\u80FD\u63D0\u53D6"}),(0,t.jsxs)("div",{style:{background:"#f5f5f5",padding:12,borderRadius:8,marginBottom:16},children:[(0,t.jsx)(g,{style:{fontSize:14},children:"\u5F53\u524D\u9009\u4E2D\u4EBA\u5458\uFF1A"}),(0,t.jsx)(g,{strong:!0,style:{fontSize:18,color:"#1677ff",display:"block"},children:h})]}),(0,t.jsx)(d.$n,{loading:p,type:"primary",theme:"solid",onClick:C,block:!0,size:"large",children:"\u5F00\u59CB AI \u5339\u914D\u8BC6\u522B"}),(0,t.jsx)(g,{type:"secondary",style:{marginTop:12,display:"block",fontSize:12},children:"\u6CE8\u610F\uFF1A\u8BF7\u786E\u4FDD\u201C\u5DE5\u5546\u6863\u6848\u201D\u5217\u5DF2\u6709 PDF \u6216\u56FE\u7247"})]})};j.createRoot(document.getElementById("root")).render((0,t.jsx)(c.StrictMode,{children:(0,t.jsx)(k,{})}))}},a=>{var x=t=>a(a.s=t);a.O(0,[121],()=>x(8194));var s=a.O()}]);
